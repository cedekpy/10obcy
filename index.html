<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10obcy - Anonimowe rozmowy</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .container { background: white; border-radius: 15px; padding: 30px; width: 100%; max-width: 500px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .screen { display: none; }
        .active { display: block; }
        h1 { text-align: center; margin-bottom: 20px; color: #333; }
        h2 { text-align: center; margin-bottom: 20px; color: #666; font-size: 18px; }
        .wojewodztwo-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0; }
        .wojewodztwo-btn { padding: 12px; border: 2px solid #ddd; border-radius: 8px; background: #f8f9fa; cursor: pointer; transition: all 0.3s; }
        .wojewodztwo-btn:hover { border-color: #667eea; }
        .wojewodztwo-btn.selected { border-color: #667eea; background: #667eea; color: white; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 8px; background: #667eea; color: white; margin: 10px 0; cursor: pointer; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        .btn-secondary { background: #6c757d; }
        .btn-danger { background: #dc3545; }
        .btn-ai { background: #28a745; }
        .btn-ai:disabled { background: #ccc; }
        .chat-container { height: 300px; border: 2px solid #ddd; border-radius: 8px; padding: 15px; margin: 15px 0; overflow-y: auto; background: #f8f9fa; }
        .message { margin: 10px 0; padding: 10px; border-radius: 8px; max-width: 80%; }
        .message.own { background: #667eea; color: white; margin-left: auto; text-align: right; }
        .message.other { background: white; border: 1px solid #ddd; }
        .status { padding: 10px; border-radius: 8px; text-align: center; margin: 10px 0; }
        .status.searching { background: #fff3cd; color: #856404; }
        .status.connected { background: #d1ecf1; color: #0c5460; }
        .status.ai { background: #d4edda; color: #155724; }
        .input-group { display: flex; gap: 10px; margin: 15px 0; }
        .message-input { flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; }
        .soon-badge { background: #ffc107; color: #856404; padding: 5px 10px; border-radius: 12px; font-size: 12px; margin-left: 10px; }
        .mode-selector { display: flex; gap: 10px; margin: 20px 0; }
        .mode-btn { flex: 1; padding: 15px; border: 2px solid #ddd; border-radius: 8px; background: #f8f9fa; cursor: pointer; text-align: center; }
        .mode-btn.selected { border-color: #667eea; background: #667eea; color: white; }
        .mode-btn.disabled { opacity: 0.6; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ekran wyboru trybu -->
        <div id="screenMode" class="screen active">
            <h1>10obcy</h1>
            <h2>Wybierz tryb rozmowy</h2>
            <div class="mode-selector">
                <div class="mode-btn selected" onclick="selectMode('human')">
                    ðŸ‘¥ Z prawym czÅ‚owiekiem
                </div>
                <div class="mode-btn disabled" onclick="selectMode('ai')">
                    ðŸ¤– Z AI
                    <span class="soon-badge">WkrÃ³tce</span>
                </div>
            </div>
            <button class="btn" onclick="showScreen('screenWojewodztwo')">Dalej</button>
        </div>

        <!-- Ekran wyboru wojewÃ³dztwa -->
        <div id="screenWojewodztwo" class="screen">
            <h1>10obcy</h1>
            <h2>Wybierz swoje wojewÃ³dztwo</h2>
            <div class="wojewodztwo-grid" id="wojewodztwaGrid"></div>
            <button id="startBtn" class="btn" disabled>Rozpocznij rozmowÄ™</button>
            <button class="btn btn-secondary" onclick="showScreen('screenMode')">PowrÃ³t</button>
        </div>

        <!-- Ekran szukania -->
        <div id="screenSearching" class="screen">
            <h1>Szukanie rozmÃ³wcy...</h1>
            <div class="status searching">Szukam kogoÅ› z twojego wojewÃ³dztwa...</div>
            <button id="cancelBtn" class="btn btn-secondary">Anuluj</button>
        </div>

        <!-- Ekran czatu -->
        <div id="screenChat" class="screen">
            <h1>Rozmowa z nieznajomym</h1>
            <div class="status connected">PoÅ‚Ä…czono! MoÅ¼esz rozmawiaÄ‡</div>
            <div class="chat-container" id="chatMessages"></div>
            <div class="input-group">
                <input type="text" id="messageInput" class="message-input" placeholder="Napisz wiadomoÅ›Ä‡...">
                <button id="sendBtn" class="btn">WyÅ›lij</button>
            </div>
            <button id="nextBtn" class="btn btn-secondary">NastÄ™pna rozmowa</button>
            <button id="endBtn" class="btn btn-danger">ZakoÅ„cz</button>
        </div>

        <!-- Ekran AI (wkrÃ³tce) -->
        <div id="screenAI" class="screen">
            <h1>Rozmowa z AI</h1>
            <div class="status ai">Tryb AI bÄ™dzie dostÄ™pny wkrÃ³tce!</div>
            <div class="chat-container" id="aiMessages">
                <div class="message other">Przepraszam, tryb rozmÃ³w z AI jest w trakcie rozwoju. SprawdÅº ponownie pÃ³Åºniej!</div>
            </div>
            <button class="btn btn-secondary" onclick="showScreen('screenMode')">PowrÃ³t do wyboru trybu</button>
        </div>
    </div>

    <script>
        // Konfiguracja Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBMM3ohzmnyBmjvcFqIOaapHzu02GFm0Hw",
            authDomain: "obcy-44426.firebaseapp.com",
            projectId: "obcy-44426",
            storageBucket: "obcy-44426.firebasestorage.app",
            messagingSenderId: "270864436948",
            appId: "1:270864436948:web:7771583aeb50dfb3c4f541",
            measurementId: "G-0JEEMG64JN"
        };

        // Inicjalizacja Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
            const auth = firebase.auth();
            console.log('ðŸ”¥ Firebase zainicjalizowany!');
        } catch (error) {
            console.error('âŒ BÅ‚Ä…d Firebase:', error);
        }

        // Lista wojewÃ³dztw
        const wojewodztwa = [
            "dolnoÅ›lÄ…skie", "kujawsko-pomorskie", "lubelskie", "lubuskie",
            "Å‚Ã³dzkie", "maÅ‚opolskie", "mazowieckie", "opolskie", 
            "podkarpackie", "podlaskie", "pomorskie", "Å›lÄ…skie",
            "Å›wiÄ™tokrzyskie", "warmiÅ„sko-mazurskie", "wielkopolskie", "zachodniopomorskie"
        ];

        let currentUser = null;
        let selectedWojewodztwo = null;
        let currentMode = 'human';

        // Init
        document.addEventListener('DOMContentLoaded', function() {
            initWojewodztwa();
            initAuth();
            setupEvents();
        });

        function initWojewodztwa() {
            const grid = document.getElementById('wojewodztwaGrid');
            wojewodztwa.forEach(woj => {
                const btn = document.createElement('button');
                btn.className = 'wojewodztwo-btn';
                btn.textContent = woj;
                btn.onclick = () => {
                    document.querySelectorAll('.wojewodztwo-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedWojewodztwo = woj;
                    document.getElementById('startBtn').disabled = false;
                };
                grid.appendChild(btn);
            });
        }

        function initAuth() {
            auth.signInAnonymously()
                .then(user => {
                    currentUser = user.user;
                    console.log('âœ… Zalogowano:', currentUser.uid);
                })
                .catch(error => {
                    console.error('âŒ BÅ‚Ä…d logowania:', error);
                });
        }

        function setupEvents() {
            document.getElementById('startBtn').onclick = startSearching;
            document.getElementById('cancelBtn').onclick = () => showScreen('screenWojewodztwo');
            document.getElementById('sendBtn').onclick = sendMessage;
            document.getElementById('nextBtn').onclick = nextConversation;
            document.getElementById('endBtn').onclick = () => showScreen('screenWojewodztwo');
            
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendMessage();
            });
        }

        function selectMode(mode) {
            if (mode === 'ai') {
                showScreen('screenAI');
                return;
            }
            
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
        }

        function showScreen(screenName) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenName).classList.add('active');
        }

        function startSearching() {
            if (!selectedWojewodztwo) return;
            
            showScreen('screenSearching');
            console.log('Szukam w:', selectedWojewodztwo);
            
            // Tymczasowo symulacja
            setTimeout(() => {
                showScreen('screenChat');
                addMessage('other', 'CzeÅ›Ä‡! MiÅ‚o CiÄ™ poznaÄ‡! Jak siÄ™ masz?');
            }, 2000);
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            if (!text) return;
            
            addMessage('own', text);
            input.value = '';
            
            // Auto-odpowiedÅº
            setTimeout(() => {
                const responses = [
                    'Fajnie! A co u Ciebie?',
                    'InteresujÄ…ce!',
                    'Opowiedz mi wiÄ™cej :)',
                    'Rozumiem, kontynuuj...',
                    'Ciekawe spostrzeÅ¼enie!'
                ];
                const response = responses[Math.floor(Math.random() * responses.length)];
                addMessage('other', response);
            }, 1000);
        }

        function addMessage(type, text) {
            const container = document.getElementById('chatMessages');
            const msg = document.createElement('div');
            msg.className = `message ${type}`;
            msg.textContent = text;
            container.appendChild(msg);
            container.scrollTop = container.scrollHeight;
        }

        function nextConversation() {
            if (confirm('ZakoÅ„czyÄ‡ tÄ™ rozmowÄ™ i szukaÄ‡ nowej?')) {
                document.getElementById('chatMessages').innerHTML = '';
                document.getElementById('messageInput').value = '';
                startSearching();
            }
        }

        console.log('ðŸš€ Aplikacja zaÅ‚adowana!');
    </script>
</body>
</html>
